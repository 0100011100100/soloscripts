<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Dashboard</title>

    <!-- Firebase Configuration -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAe0hXfAJ0ijKNiGgAVfv4zG1ngADF2E4c",
            authDomain: "chatapp-90c78.firebaseapp.com",
            projectId: "chatapp-90c78",
            storageBucket: "chatapp-90c78.appspot.com",
            messagingSenderId: "195015101932",
            appId: "1:195015101932:web:f352296f341c58458a84c9",
            databaseURL: "https://chatapp-90c78-default-rtdb.firebaseio.com"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function sendMessage(username, messageText, profilePicUrl, isBot = false) {
            db.ref('messages').push().set({
                username: username,
                message: messageText,
                profilePic: profilePicUrl,
                timestamp: new Date().toISOString(),
                isBot: isBot // Indicate if the message is from the bot
            });
        }

        function listenForMessages() {
            db.ref('messages').on('child_added', (snapshot) => {
                const messageData = snapshot.val();
                addMessageToChat(messageData);
            });
        }

        function addMessageToChat(messageData) {
            const message = document.createElement('div');
            message.classList.add('message');

            const profileImage = document.createElement('img');
            profileImage.src = messageData.profilePic || 'default-profile-pic.png';
            profileImage.classList.add('profile-pic');

            const text = document.createElement('span');
            let badgeText = '';

            if (messageData.isBot) {
                badgeText = '<strong class="bot-badge">Bot:</strong>'; // Updated to remove emoji
            }

            text.innerHTML = `${badgeText} ${messageData.username}: ${messageData.message}`;
            message.appendChild(profileImage);
            message.appendChild(text);
            document.getElementById('messages-container').appendChild(message);
        }

        function getRandomGoofyResponse() {
            const responses = [
                "Did someone mention bananas?",
                "I just saw a flying toaster!",
                "Why did the chicken cross the road? To get to the other side!",
                "I dreamt of spaghetti last night!",
                "Do you think cats know they are cute?",
                "What if clouds are just fluffy thoughts?",
                "I'm just a bot, but I'm loving this chat!",
                "Have you ever tried to catch a rainbow?",
                "Itâ€™s all about the jellybeans, right?",
                "Just keep swimming, just keep swimming!"
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        window.onload = function() {
            const username = localStorage.getItem('username') || 'Guest';
            const profilePictureUrl = localStorage.getItem('profilePic') || 'default-profile-pic.png';
            document.getElementById('username-display').textContent = username;
            document.getElementById('profile-pic').src = profilePictureUrl;
            listenForMessages();

            document.getElementById('chat-input').addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    const messageText = event.target.value;
                    if (messageText) {
                        sendMessage(username, messageText, profilePictureUrl);

                        // Randomly decide whether to use a goofy response or just an acknowledgment
                        const botResponse = Math.random() > 0.5 ? getRandomGoofyResponse() : "That's interesting!";
                        sendMessage("RandomBot", botResponse, 'default-bot-pic.png', true);
                        
                        event.target.value = ''; // Clear the input
                    }
                }
            });
        };
    </script>

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #36393f;
            color: #dcddde;
            font-family: "Helvetica", Arial, sans-serif;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #2f3136;
            padding: 10px 20px;
            box-shadow: 0px 4px 2px -2px rgba(0,0,0,0.5);
        }

        .profile {
            display: flex;
            align-items: center;
        }

        .profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            border: 3px solid #7289da;
        }

        .bot-badge {
            color: #3ba55c; /* Color for the bot's badge */
            font-weight: bold;
        }

        .messages {
            margin-top: 20px;
        }

        .messages .message {
            margin: 10px 0;
            padding: 10px;
            background-color: #2f3136;
            border-radius: 5px;
            display: flex;
            align-items: center;
        }

        .profile-pic {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            border: 3px solid #7289da;
            cursor: pointer;
        }

        .chat-box {
            padding: 20px;
        }

        .chat-box input {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: none;
            font-size: 14px;
            background-color: #40444b;
            color: #dcddde;
        }
    </style>
</head>
<body>

<div class="header">
    <div class="profile">
        <img id="profile-pic" src="default-profile-pic.png" alt="Profile Picture">
        <div class="username" id="username-display"></div>
    </div>
</div>

<div class="chat-box">
    <input type="text" id="chat-input" placeholder="Type your message here...">
    <div class="messages" id="messages-container"></div>
</div>

</body>
</html>
