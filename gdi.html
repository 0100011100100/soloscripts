<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixelated Chaos with Bytebeat Sound</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: black;
            overflow: hidden;
        }
        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>

<canvas id="chaosCanvas"></canvas>
<audio id="bytebeatAudio" loop></audio>

<script>
    const canvas = document.getElementById('chaosCanvas');
    const ctx = canvas.getContext('2d');
    const audio = document.getElementById('bytebeatAudio');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Generate random colors
    function randomColor() {
        const r = Math.floor(Math.random() * 256);
        const g = Math.floor(Math.random() * 256);
        const b = Math.floor(Math.random() * 256);
        return `rgb(${r},${g},${b})`;
    }

    // Bytebeat sound function 1
    function bytebeat1(t) {
        return 2 * t * (t & 16384 ? 6 : 5) * (4 - (3 & (t >> 8))) >> (3 & -t >> (t & 4096 ? 2 : 15)) |
               t >> (t & 8192 ? (t & 4096 ? 4 : 5) : 3);
    }

    // Bytebeat sound function 2
    function bytebeat2(t) {
        return 2 * t * (t & 16384 ? 6 : 5) * (4 - (3 & (t >> 8))) >> (3 & -t >> (t & 4096 ? 2 : 15)) |
               t >> (t & 8192 ? (t & 4096 ? 4 : 5) : 3);
    }

    // Create audio buffer with first bytebeat sound
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const bufferSize = audioContext.sampleRate;
    
    // Buffer for first bytebeat sound
    const buffer1 = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
    const data1 = buffer1.getChannelData(0);
    for (let i = 0; i < bufferSize; i++) {
        const t = i;
        data1[i] = bytebeat1(t) / 32767; // Normalize to [-1, 1]
    }

    // Buffer for second bytebeat sound
    const buffer2 = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
    const data2 = buffer2.getChannelData(0);
    for (let i = 0; i < bufferSize; i++) {
        const t = i;
        data2[i] = bytebeat2(t) / 32767; // Normalize to [-1, 1]
    }

    // Create audio source for first bytebeat sound
    let source = audioContext.createBufferSource();
    source.buffer = buffer1;
    source.connect(audioContext.destination);
    source.start();

    // Function to draw pixelated chaotic shapes
    function drawPixelatedShapes() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const numShapes = 15; // Number of main shapes

        for (let i = 0; i < numShapes; i++) {
            const size = Math.random() * 100 + 50; // Size of the main shape
            const x = Math.random() * canvas.width;
            const y = Math.random() * canvas.height;

            // Draw the main pixelated shape
            ctx.fillStyle = randomColor();
            ctx.fillRect(x, y, size, size);

            // Create smaller cloned shapes
            for (let j = 0; j < 5; j++) {
                const cloneSize = size * (0.5 ** j); // Reduce size with each clone
                ctx.fillStyle = randomColor();
                ctx.fillRect(x + (Math.random() * 30 - 15), y + (Math.random() * 30 - 15), cloneSize, cloneSize);
            }
        }

        // Create shaking effect
        for (let i = 0; i < 20; i++) {
            const shakeX = Math.random() * canvas.width;
            const shakeY = Math.random() * canvas.height;
            ctx.strokeStyle = randomColor();
            ctx.lineWidth = Math.random() * 5 + 1;
            ctx.beginPath();
            ctx.moveTo(shakeX + Math.random() * 10 - 5, shakeY + Math.random() * 10 - 5);
            ctx.lineTo(shakeX + Math.random() * 10 - 5, shakeY + Math.random() * 10 - 5 + 100);
            ctx.stroke();
        }

        requestAnimationFrame(drawPixelatedShapes);
    }

    // Start drawing and playing audio
    drawPixelatedShapes();

    // Switch audio source after 10 seconds
    setTimeout(() => {
        // Stop the current source
        source.stop();

        // Create new audio source for second bytebeat sound
        source = audioContext.createBufferSource();
        source.buffer = buffer2;
        source.connect(audioContext.destination);
        source.start();
    }, 10000);

    // Resize canvas on window resize
    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
</script>

</body>
</html>
