<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Token Extractor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-top: 10px;
        }
        button {
            margin-top: 10px;
        }
        #output, #tokens {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
            background: #f9f9f9;
        }
        .token-info {
            margin-top: 10px;
            color: blue;
        }
        .image-container {
            margin-top: 10px;
        }
        img {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <h1>Advanced Token Extractor with AI Explanations</h1>
    <textarea id="codeInput" placeholder="Paste your JavaScript code here..."></textarea>
    <button id="extractButton">Extract Tokens</button>
    
    <div id="output"></div>
    <div id="tokens"></div>
    <div id="tokenInfo" class="token-info"></div>
    <div id="imageContainer" class="image-container"></div>

    <script>
        document.getElementById('extractButton').addEventListener('click', () => {
            const code = document.getElementById('codeInput').value;
            document.getElementById('output').innerText = `Original Code:\n${code}`;

            // Regular expressions to extract potential tokens
            const jwtPattern = /([A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+)/g;
            const apiKeyPattern = /['"]?([A-Za-z0-9-_]{32,})['"]?/g;
            const accessTokenPattern = /accessToken:\s*['"]?([A-Za-z0-9-_]{32,})['"]?/g;

            // Extracting tokens
            const jwtMatches = code.match(jwtPattern) || [];
            const apiKeyMatches = code.match(apiKeyPattern) || [];
            const accessTokenMatches = code.match(accessTokenPattern) || [];

            // Display extracted tokens
            const allTokens = [...jwtMatches, ...apiKeyMatches, ...accessTokenMatches];
            document.getElementById('tokens').innerText = allTokens.length > 0 
                ? `Extracted Tokens:\n${allTokens.join('\n')}`
                : 'No tokens found.';

            // Provide AI-powered explanations for each type of token
            let explanations = '';
            let images = '';

            allTokens.forEach(token => {
                if (jwtPattern.test(token)) {
                    explanations += `\n- **${token}**: This is a JWT (JSON Web Token), typically used for authentication. It consists of three parts: Header, Payload, and Signature. JWTs are often placed in the Authorization header as a Bearer token. If compromised, attackers can impersonate users, gaining unauthorized access to sensitive resources.`;
                    images += `<img src="https://via.placeholder.com/400x200?text=JWT+Token+Placement" alt="JWT Token Placement">`;
                }
                if (apiKeyPattern.test(token)) {
                    explanations += `\n- **${token}**: This is an API key, used for authenticating requests made to an API. API keys are often included in HTTP request headers or as query parameters. If stolen, an attacker can access your services, potentially leading to data breaches or unauthorized actions.`;
                    images += `<img src="https://via.placeholder.com/400x200?text=API+Key+Usage" alt="API Key Usage">`;
                }
                if (accessTokenPattern.test(token)) {
                    explanations += `\n- **${token}**: This is an access token, usually granted after user authentication. Access tokens should be included in HTTP requests to protected endpoints. If an attacker gets hold of this token, they can access user accounts and sensitive data.`;
                    images += `<img src="https://via.placeholder.com/400x200?text=Access+Token+Usage" alt="Access Token Usage">`;
                }
            });

            // Display token information and images
            document.getElementById('tokenInfo').innerText = explanations || 'No token explanations available.';
            document.getElementById('imageContainer').innerHTML = images || '';
        });
    </script>
</body>
</html>
